# Configuration for Kidney dataset (QUBIQ Challenge)
# This dataset contains CT scans for kidney segmentation

dataset:
  name: "kidney"
  description: "One-channel CT for kidney segmentation"
  modality: "CT"
  task_id: 1
  num_experts: 3  # Three expert annotations per image
  num_channels: 1

data:
  # Update these paths to your data location
  train_dir: "data/kidney/training"
  val_dir: "data/kidney/validation"
  test_dir: "data/kidney/test"

  # Data preprocessing
  image_size: 256
  use_intensity_windowing: true  # Important for CT images!
  normalization_method: "min-max"
  intensity_range: [0.0, 1.0]

model:
  architecture: "UNetDeepLSTM"  # LSTM variant works well for kidney
  base_filters: 16
  use_batch_norm: true
  use_dropout: true
  dropout_rate: 0.5
  output_activation: "sigmoid"

training:
  batch_size: 1
  epochs: 500
  learning_rate: 0.0001
  loss_function: "dice_loss"

  # Metrics to track
  metrics:
    - "dice_coefficient"
    - "precision"
    - "recall"

  # Data augmentation (no horizontal flip for kidney - anatomically specific)
  augmentation:
    enabled: true
    rotation_range: 10.0
    width_shift_range: 0.1
    height_shift_range: 0.1
    horizontal_flip: false  # Kidneys are anatomically specific
    vertical_flip: false
    zoom_range: null

  # Callbacks
  callbacks:
    early_stopping:
      enabled: true
      patience: 20
      monitor: "val_loss"

    reduce_lr:
      enabled: true
      factor: 0.5
      patience: 10
      min_lr: 1e-7

    checkpoint:
      enabled: true
      save_best_only: true
      monitor: "val_loss"

evaluation:
  # Threshold values for evaluation
  thresholds: [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9]

  # Multi-expert ensemble evaluation
  ensemble_method: "mean"

output:
  model_dir: "models/kidney"
  checkpoint_dir: "checkpoints/kidney"
  log_dir: "logs/kidney"
  results_dir: "results/kidney"
